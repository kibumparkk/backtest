# ë°±í…ŒìŠ¤íŒ… ì½”ë“œ ê²€í†  ë³´ê³ ì„œ

> ê°€ì´ë“œë¼ì¸: BACKTESTING_BIAS_GUIDE.md ë° BACKTESTING_CHECKLIST.md ê¸°ì¤€
> ê²€í†  ëŒ€ìƒ: ì´ ë¸Œëœì¹˜ì—ì„œ ì‘ì„±ëœ ëª¨ë“  ë°±í…ŒìŠ¤íŒ… ì½”ë“œ

---

## ê²€í†  ëŒ€ìƒ íŒŒì¼

1. âœ… `crypto_portfolio_strategy_comparison_fixed.py` (ê¶Œì¥ ë²„ì „)
2. âš ï¸ `crypto_portfolio_strategy_comparison.py` (ì´ˆê¸° ë²„ì „)
3. âœ… `strategy_review_analysis.py` (ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸)

---

## 1. crypto_portfolio_strategy_comparison_fixed.py (ê¶Œì¥ ë²„ì „)

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ê²€í† 

#### âœ… Look-ahead Bias (ë¯¸ë˜ ì •ë³´ ì‚¬ìš©)

**í„°í‹€ íŠ¸ë ˆì´ë”© ì „ëµ**:
```python
# Line 79-81: ì§€í‘œ ê³„ì‚°
df['entry_high'] = df['High'].rolling(window=entry_period).max().shift(1)  âœ…
df['exit_low'] = df['Low'].rolling(window=exit_period).min().shift(1)     âœ…

# Line 85-94: ì‹ í˜¸ ìƒì„± (ë‹¹ì¼ ë°ì´í„° ì‚¬ìš©)
if df.iloc[i]['High'] > df.iloc[i]['entry_high']:  âœ… shift(1)ëœ ë°ì´í„° ì‚¬ìš©
```
**íŒì •**: âœ… **í†µê³¼** - shift(1) ì‚¬ìš©ìœ¼ë¡œ ë¯¸ë˜ ì •ë³´ ì‚¬ìš© ë°©ì§€

**RSI 55 ì „ëµ**:
```python
# Line 140: RSI ê³„ì‚° (ë‹¹ì¼ ì¢…ê°€ ê¸°ì¤€)
df['RSI'] = self.calculate_rsi(df['Close'], rsi_period)  âœ…

# Line 143: ì‹ í˜¸ ìƒì„± (ë‹¹ì¼ ì¢…ê°€ ê¸°ì¤€)
df['signal'] = (df['RSI'] >= rsi_threshold).astype(int)  âœ…

# Line 150: ìˆ˜ìµë¥  ê³„ì‚° (ì „ì¼ ì‹ í˜¸ë¡œ ë‹¹ì¼ ìˆ˜ìµ)
df['returns'] = df['signal'].shift(1) * df['daily_price_return']  âœ…

# Line 146, 154-155: ìŠ¬ë¦¬í”¼ì§€ (ë‹¹ì¼ í¬ì§€ì…˜ ë³€ê²½ ì‹œ)
df['position_change'] = df['signal'].diff()
slippage_cost[df['position_change'] == 1] = -self.slippage  âœ…
slippage_cost[df['position_change'] == -1] = -self.slippage  âœ…
```

**íƒ€ì„ë¼ì¸ ê²€ì¦**:
```
Day 1 ì¢…ê°€: RSI=60 â†’ signal=1 (ë§¤ìˆ˜ ê²°ì •)
Day 2:
  - returns = signal.shift(1) * price_return = 0 * return = 0 (ì „ì¼ ë¯¸ë³´ìœ )
  - position_change = 1 (ë§¤ìˆ˜ ë°œìƒ)
  - slippage = -0.2% (ë§¤ìˆ˜ ë¹„ìš©)
  - ì´ ìˆ˜ìµ: -0.2% âœ…

Day 3:
  - returns = signal.shift(1) * price_return = 1 * return (ë³´ìœ  ì¤‘)
  - position_change = 0 (ë³€í™” ì—†ìŒ)
  - slippage = 0
  - ì´ ìˆ˜ìµ: price_return âœ…

Day 4 ì¢…ê°€: RSI=50 â†’ signal=0 (ë§¤ë„ ê²°ì •)
  - returns = signal.shift(1) * price_return = 1 * return (ë§¤ë„ ì „ê¹Œì§€ ë³´ìœ )
  - position_change = -1 (ë§¤ë„ ë°œìƒ)
  - slippage = -0.2% (ë§¤ë„ ë¹„ìš©)
  - ì´ ìˆ˜ìµ: price_return - 0.2% âœ…
```

**íŒì •**: âœ… **í†µê³¼** - ë¡œì§ ì •í™•í•¨

**SMA 30 ì „ëµ**:
```python
# Line 172: ìˆ˜ìµë¥  ê³„ì‚°
df['returns'] = df['position'].shift(1) * df['daily_price_return']  âœ…
```
**íŒì •**: âœ… **í†µê³¼** - shift(1) ëª…ì‹œì  ì‚¬ìš©

#### âœ… Perfect Execution Bias (ì™„ë²½í•œ ì²´ê²°)

**í„°í‹€ íŠ¸ë ˆì´ë”© ì „ëµ**:
```python
# Line 101-103: ë§¤ìˆ˜ (ìˆ˜ì •ë¨!)
if df.iloc[i]['position'] == 1 and df.iloc[i-1]['position'] == 0:
    df.iloc[i, df.columns.get_loc('buy_price')] = df.iloc[i]['Close'] * (1 + self.slippage)  âœ…

# Line 104-107: ë§¤ë„ (ìˆ˜ì •ë¨!)
elif df.iloc[i]['position'] == 0 and df.iloc[i-1]['position'] == 1:
    sell_price = df.iloc[i]['Close'] * (1 - self.slippage)  âœ…
    df.iloc[i, df.columns.get_loc('returns')] = (sell_price / buy_price - 1)  âœ…
```
**íŒì •**: âœ… **í†µê³¼** - í˜„ì‹¤ì ì¸ ì¢…ê°€ ì²´ê²° + ì–‘ë°©í–¥ ìŠ¬ë¦¬í”¼ì§€

**RSI 55 ì „ëµ**:
```python
# Line 147-149: ìŠ¬ë¦¬í”¼ì§€ ì ìš©
slippage_cost = pd.Series(0.0, index=df.index)
slippage_cost[df['position_change'] == 1] = -self.slippage   # ë§¤ìˆ˜ âœ…
slippage_cost[df['position_change'] == -1] = -self.slippage  # ë§¤ë„ âœ…
```
**íŒì •**: âœ… **í†µê³¼** - ìŠ¬ë¦¬í”¼ì§€ ì–‘ë°©í–¥ ì ìš©

**SMA 30 ì „ëµ**:
```python
# Line 176-178: ìŠ¬ë¦¬í”¼ì§€ ì ìš©
slippage_cost = pd.Series(0.0, index=df.index)
slippage_cost[df['position_change'] == 1] = -self.slippage   âœ…
slippage_cost[df['position_change'] == -1] = -self.slippage  âœ…
```
**íŒì •**: âœ… **í†µê³¼** - ìŠ¬ë¦¬í”¼ì§€ ì–‘ë°©í–¥ ì ìš©

#### âš ï¸ Data Snooping Bias (ê³¼ì í•©)

```python
# íŒŒë¼ë¯¸í„° í•˜ë“œì½”ë”©
strategy_turtle_trading(entry_period=20, exit_period=10)  # í‘œì¤€ê°’
strategy_rsi_55(rsi_period=14, rsi_threshold=55)         # í‘œì¤€ê°’
strategy_sma_30(sma_period=30)                           # í‘œì¤€ê°’
```
**íŒì •**: âš ï¸ **ì£¼ì˜** - Train/Test ë¶„í•  ì—†ìŒ
- íŒŒë¼ë¯¸í„°ëŠ” í‘œì¤€ê°’ ì‚¬ìš© (ì–‘í˜¸)
- í•˜ì§€ë§Œ ë°ì´í„° ë¶„í•  ì—†ì´ ì „ì²´ ê¸°ê°„ ì‚¬ìš©
- **ê¶Œì¥**: ì‹¤ì „ ì ìš© ì „ ë³„ë„ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ê²€ì¦ í•„ìš”

#### âœ… Transaction Cost (ê±°ë˜ ë¹„ìš©)

```python
# Line 30: ìŠ¬ë¦¬í”¼ì§€ ì„¤ì •
slippage=0.002  # 0.2% âœ…

# í„°í‹€: ë§¤ìˆ˜/ë§¤ë„ ê°ê° ì ìš©
buy_price = df.iloc[i]['Close'] * (1 + self.slippage)   âœ…
sell_price = df.iloc[i]['Close'] * (1 - self.slippage)  âœ…

# RSI/SMA: ì‹ í˜¸ ë³€ê²½ ì‹œ ì ìš©
slippage_cost[df['position_change'] == 1] = -self.slippage  âœ…
```
**íŒì •**: âœ… **í†µê³¼** - ìŠ¬ë¦¬í”¼ì§€ 0.2% ì ìš© (ì•”í˜¸í™”í ì ì • ìˆ˜ì¤€)

### ğŸ¯ ì¢…í•© í‰ê°€: crypto_portfolio_strategy_comparison_fixed.py

| í•­ëª© | ìƒíƒœ | ë¹„ê³  |
|------|------|------|
| Look-ahead Bias | âœ… í†µê³¼ | shift(1) ì ì ˆíˆ ì‚¬ìš© |
| Perfect Execution | âœ… í†µê³¼ | í˜„ì‹¤ì  ê°€ê²©, ìŠ¬ë¦¬í”¼ì§€ ì ìš© |
| Data Snooping | âš ï¸ ì£¼ì˜ | Train/Test ë¶„í•  ì—†ìŒ |
| Transaction Cost | âœ… í†µê³¼ | ìŠ¬ë¦¬í”¼ì§€ 0.2% ì ìš© |
| **ì „ì²´ íŒì •** | ğŸŸ¢ **GREEN** | ì‹¤ì „ ì ìš© ê°€ëŠ¥ (ì¶”ê°€ ê²€ì¦ ê¶Œì¥) |

**ê°œì„  ê¶Œì¥ì‚¬í•­**:
1. Train/Test ë°ì´í„° ë¶„í•  ì¶”ê°€ (ì˜ˆ: 2018-2021 Train, 2022-2024 Test)
2. Walk-Forward Analysis ê³ ë ¤
3. ë‹¤ë¥¸ ì¢…ëª©êµ°ì—ì„œë„ í…ŒìŠ¤íŠ¸

---

## 2. crypto_portfolio_strategy_comparison.py (ì´ˆê¸° ë²„ì „)

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ê²€í† 

#### âœ… Look-ahead Bias

```python
# ë™ì¼: shift(1) ì‚¬ìš©
df['entry_high'] = df['High'].rolling(window=entry_period).max().shift(1)  âœ…
```
**íŒì •**: âœ… **í†µê³¼**

#### âŒ Perfect Execution Bias (ë¬¸ì œ ë°œê²¬!)

```python
# Line 103: ë§¤ìˆ˜ ê°€ê²© - ë¬¸ì œ!
df.iloc[i, df.columns.get_loc('buy_price')] = df.iloc[i]['entry_high']  âŒ

# Line 107: ë§¤ë„ ê°€ê²© - ë¬¸ì œ!
df.iloc[i, df.columns.get_loc('returns')] = (df.iloc[i]['exit_low'] / buy_price - 1) - self.slippage  âŒ
```

**ë¬¸ì œì **:
1. **ë§¤ìˆ˜**: entry_highë¥¼ ëŒíŒŒí–ˆëŠ”ë° entry_high ê°€ê²©ì— ë§¤ìˆ˜ (ë¶ˆê°€ëŠ¥!)
2. **ë§¤ë„**: exit_lowë¥¼ í•˜í–¥ëŒíŒŒí–ˆëŠ”ë° exit_low ê°€ê²©ì— ë§¤ë„ (ë¶ˆê°€ëŠ¥!)
3. ìŠ¬ë¦¬í”¼ì§€ëŠ” ìˆì§€ë§Œ, ì²´ê²° ê°€ê²© ìì²´ê°€ ë¹„í˜„ì‹¤ì 

**ì‹¤ì œ ì˜í–¥**:
- BTC ìˆ˜ìµë¥ : 6,203% (ì‹¤ì œëŠ” 3,250%)
- ê³¼ëŒ€í‰ê°€: **90.88%**

**íŒì •**: âŒ **ì‹¤íŒ¨** - Perfect Execution Bias ì‹¬ê°

### ğŸ¯ ì¢…í•© í‰ê°€: crypto_portfolio_strategy_comparison.py

| í•­ëª© | ìƒíƒœ | ë¹„ê³  |
|------|------|------|
| Look-ahead Bias | âœ… í†µê³¼ | shift(1) ì‚¬ìš© |
| Perfect Execution | âŒ **ì‹¤íŒ¨** | ë¹„í˜„ì‹¤ì  ì²´ê²° ê°€ê²© |
| Data Snooping | âš ï¸ ì£¼ì˜ | Train/Test ë¶„í•  ì—†ìŒ |
| Transaction Cost | âš ï¸ ë¶€ë¶„ | ìŠ¬ë¦¬í”¼ì§€ ìˆìœ¼ë‚˜ ë¶ˆì¶©ë¶„ |
| **ì „ì²´ íŒì •** | ğŸ”´ **RED** | ì‚¬ìš© ê¸ˆì§€ |

**ê²°ë¡ **: âŒ **ì‚¬ìš©í•˜ì§€ ë§ ê²ƒ** - Fixed ë²„ì „ ì‚¬ìš© í•„ìˆ˜

---

## 3. strategy_review_analysis.py (ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸)

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ê²€í† 

ì´ íŒŒì¼ì€ ë°±í…ŒìŠ¤íŒ… ì½”ë“œê°€ ì•„ë‹Œ **ë¶„ì„ ë° ë¹„êµ ìŠ¤í¬ë¦½íŠ¸**ì´ë¯€ë¡œ ë‹¤ë¥¸ ê¸°ì¤€ ì ìš©

#### ëª©ì 
- ì˜ëª»ëœ ë²„ì „(ë¹„í˜„ì‹¤ì )ê³¼ ì˜¬ë°”ë¥¸ ë²„ì „(í˜„ì‹¤ì ) ë¹„êµ
- ë¬¸ì œì  ì‹œê°í™” ë° ë³´ê³ 

#### ê²€í†  ì‚¬í•­

**ì˜ëª»ëœ ë²„ì „ ì¬í˜„** (Line 27-79):
```python
# ì˜ë„ì ìœ¼ë¡œ ì˜ëª»ëœ ë°©ì‹ ì¬í˜„
buy_price = df.iloc[i]['entry_high']  # ë¹„í˜„ì‹¤ì  (ì˜ë„ì )
```
**íŒì •**: âœ… **ì ì ˆ** - ë¬¸ì œ ì¬í˜„ì´ ëª©ì 

**ì˜¬ë°”ë¥¸ ë²„ì „ ì¬í˜„** (Line 81-111):
```python
# í˜„ì‹¤ì  ê°€ê²©ìœ¼ë¡œ ìˆ˜ì •
buy_price = df.iloc[i]['Close'] * (1 + slippage)  âœ…
```
**íŒì •**: âœ… **ì ì ˆ** - ì˜¬ë°”ë¥¸ ìˆ˜ì • ë°©ë²• ì œì‹œ

**ë¹„êµ ë¶„ì„** (Line 113-150):
- ë‘ ë²„ì „ì˜ ìˆ˜ìµë¥  ë¹„êµ
- ì°¨ì´ ê³„ì‚° ë° ì‹œê°í™”
**íŒì •**: âœ… **ì ì ˆ** - êµìœ¡ ëª©ì ìœ¼ë¡œ ì í•©

### ğŸ¯ ì¢…í•© í‰ê°€: strategy_review_analysis.py

| í•­ëª© | ìƒíƒœ | ë¹„ê³  |
|------|------|------|
| ëª©ì  ì í•©ì„± | âœ… ìš°ìˆ˜ | ë¬¸ì œì  ëª…í™•íˆ ì„¤ëª… |
| ì½”ë“œ ì •í™•ì„± | âœ… ìš°ìˆ˜ | ë¹„êµ ë¶„ì„ ì •í™•í•¨ |
| êµìœ¡ì  ê°€ì¹˜ | âœ… ìš°ìˆ˜ | ì‹¤ì œ ì‚¬ë¡€ë¡œ í•™ìŠµ ê°€ëŠ¥ |
| **ì „ì²´ íŒì •** | ğŸŸ¢ **GREEN** | êµìœ¡ìš©ìœ¼ë¡œ í›Œë¥­í•¨ |

---

## 4. ê¸°íƒ€ ë°œê²¬ì‚¬í•­

### âœ… ê¸ì •ì ì¸ ì 

1. **ëª…í™•í•œ ë¬¸ì„œí™”**
   - ê° ì „ëµì— docstringìœ¼ë¡œ ì„¤ëª…
   - íŒŒë¼ë¯¸í„° ì˜ë¯¸ ëª…ì‹œ

2. **ì¼ê´€ëœ ìŠ¬ë¦¬í”¼ì§€**
   - ëª¨ë“  ì „ëµì— 0.2% ì ìš© (ì•”í˜¸í™”í ì ì •)

3. **í˜„ì‹¤ì ì¸ ê°€ì •**
   - ì¢…ê°€ ì²´ê²° ì‚¬ìš©
   - ì–‘ë°©í–¥ ìŠ¬ë¦¬í”¼ì§€ ì ìš©

### âš ï¸ ê°œì„  í•„ìš” ì‚¬í•­

1. **ë°ì´í„° ë¶„í•  ë¶€ì¬**
   ```python
   # í˜„ì¬
   start_date='2018-01-01', end_date=None  # ì „ì²´ ê¸°ê°„

   # ê¶Œì¥
   train_start='2018-01-01', train_end='2021-12-31'
   test_start='2022-01-01', test_end='2024-12-31'
   ```

2. **ìˆ˜ìˆ˜ë£Œ ë¯¸ë°˜ì˜**
   ```python
   # í˜„ì¬: ìŠ¬ë¦¬í”¼ì§€ë§Œ
   slippage = 0.002  # 0.2%

   # ê¶Œì¥: ìˆ˜ìˆ˜ë£Œ ì¶”ê°€
   slippage = 0.002  # 0.2%
   fee = 0.001       # 0.1% (ë°”ì´ë‚¸ìŠ¤ ê¸°ì¤€)
   total_cost = slippage + fee  # 0.3%
   ```

3. **ì‹œì¥ ì¶©ê²© ë¯¸ê³ ë ¤**
   - ëŒ€ëŸ‰ ê±°ë˜ ì‹œ ê°€ê²© ì˜í–¥ ì—†ë‹¤ê³  ê°€ì •
   - ì†Œì•¡ íˆ¬ìë§Œ ì ìš© ê°€ëŠ¥í•˜ë‹¤ëŠ” ëª…ì‹œ í•„ìš”

4. **íŒŒë¼ë¯¸í„° ë¯¼ê°ë„ ë¶„ì„ ë¶€ì¬**
   - íŒŒë¼ë¯¸í„° ë³€ê²½ ì‹œ ì„±ê³¼ ë³€í™” í…ŒìŠ¤íŠ¸ ì—†ìŒ
   - Walk-Forward Analysis ì—†ìŒ

---

## 5. ì²´í¬ë¦¬ìŠ¤íŠ¸ë³„ ì¢…í•© í‰ê°€

### í•„ìˆ˜ ì²´í¬ (BACKTESTING_CHECKLIST.md ê¸°ì¤€)

| ì²´í¬ í•­ëª© | Fixed ë²„ì „ | ì´ˆê¸° ë²„ì „ |
|-----------|------------|-----------|
| 1ï¸âƒ£ Look-ahead Bias | âœ… shift(1) ì‚¬ìš© | âœ… shift(1) ì‚¬ìš© |
| 2ï¸âƒ£ Perfect Execution | âœ… í˜„ì‹¤ì  ê°€ê²© | âŒ ë¹„í˜„ì‹¤ì  ê°€ê²© |
| 3ï¸âƒ£ Data Snooping | âš ï¸ ë¶„í•  ì—†ìŒ | âš ï¸ ë¶„í•  ì—†ìŒ |
| 4ï¸âƒ£ Transaction Cost | âœ… ìŠ¬ë¦¬í”¼ì§€ 0.2% | âš ï¸ ë¶ˆì¶©ë¶„ |

### ë ˆë“œ í”Œë˜ê·¸ ì²´í¬

**Fixed ë²„ì „ ê²°ê³¼**:
```
- Turtle Trading Portfolio: 5,646% (CAGR 80.52%, Sharpe 1.12)
- SMA 30 Portfolio: 5,942% (CAGR 81.85%, Sharpe 1.60)
- RSI 55 Portfolio: 3,142% (CAGR 66.07%, Sharpe 1.45)
```

| ë ˆë“œ í”Œë˜ê·¸ | ê¸°ì¤€ | Fixed | ì´ˆê¸° | íŒì • |
|-------------|------|-------|------|------|
| ìƒ¤í”„ ë¹„ìœ¨ | < 3.0 | 1.12~1.60 âœ… | 1.28 âœ… | í†µê³¼ |
| ìŠ¹ë¥  | < 70% | 43~51% âœ… | 48% âœ… | í†µê³¼ |
| MDD | -20~-50% | -29~-40% âœ… | -22% âš ï¸ | Fixed ë” í˜„ì‹¤ì  |
| Train/Test ì°¨ì´ | < 50% | N/A | N/A | ì¸¡ì • ë¶ˆê°€ |

**íŒì •**:
- Fixed ë²„ì „: ğŸŸ¢ **GREEN** (ëª¨ë“  ì§€í‘œ í•©ë¦¬ì )
- ì´ˆê¸° ë²„ì „: ğŸ”´ **RED** (MDDê°€ ë„ˆë¬´ ë‚®ìŒ = ì˜ì‹¬)

---

## 6. ìµœì¢… ê¶Œì¥ì‚¬í•­

### ì¦‰ì‹œ ì¡°ì¹˜ í•„ìš” (Critical)

âŒ **crypto_portfolio_strategy_comparison.py ì‚¬ìš© ê¸ˆì§€**
- Perfect Execution Biasë¡œ 91% ê³¼ëŒ€í‰ê°€
- ëª¨ë“  ì‚¬ìš©ìì—ê²Œ Fixed ë²„ì „ ì‚¬ìš© ì•ˆë‚´

### ê°œì„  ê¶Œì¥ì‚¬í•­ (Important)

1. **ë°ì´í„° ë¶„í•  ì¶”ê°€**
   ```python
   # crypto_portfolio_strategy_comparison_fixed.pyì— ì¶”ê°€
   def run_analysis(self, train_end='2021-12-31'):
       # Train ë°ì´í„°ë¡œ ìµœì í™”
       # Test ë°ì´í„°ë¡œ ê²€ì¦
   ```

2. **ìˆ˜ìˆ˜ë£Œ ì¶”ê°€**
   ```python
   slippage = 0.002
   fee = 0.001
   total_cost = slippage + fee  # 0.3%
   ```

3. **ë¯¼ê°ë„ ë¶„ì„ ì¶”ê°€**
   ```python
   # íŒŒë¼ë¯¸í„° Â±20% ë³€ê²½ ì‹œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
   for param in [0.8*default, default, 1.2*default]:
       test_strategy(param)
   ```

### í–¥í›„ ê°œë°œ ì‹œ (Nice to Have)

1. **Walk-Forward Analysis êµ¬í˜„**
2. **ì—¬ëŸ¬ ê¸°ê°„ í…ŒìŠ¤íŠ¸ (ê°•ê±´ì„±)**
3. **Monte Carlo ì‹œë®¬ë ˆì´ì…˜**
4. **ìµœëŒ€ ì—°ì† ì†ì‹¤ í†µê³„**

---

## 7. ê²°ë¡ 

### âœ… ì˜ëœ ì 

1. **ë¬¸ì œ ë°œê²¬ ë° ìˆ˜ì •**: Perfect Execution Biasë¥¼ ìŠ¤ìŠ¤ë¡œ ë°œê²¬í•˜ê³  ìˆ˜ì •
2. **ìƒì„¸í•œ ë¬¸ì„œí™”**: ë¬¸ì œì ê³¼ í•´ê²°ì±…ì„ ëª…í™•íˆ ë¬¸ì„œí™”
3. **êµìœ¡ì  ê°€ì¹˜**: ì‹¤ì œ ì‚¬ë¡€ë¡œ ë‹¤ë¥¸ ê°œë°œìë“¤ì—ê²Œ êµí›ˆ ì œê³µ
4. **í˜„ì‹¤ì ì¸ ê°€ì •**: Fixed ë²„ì „ì€ í˜„ì‹¤ì ì¸ ì²´ê²° ê°€ê²© ì‚¬ìš©

### âš ï¸ ì£¼ì˜í•  ì 

1. **ì´ˆê¸° ë²„ì „ ì‚¬ìš© ê¸ˆì§€**: ë°˜ë“œì‹œ Fixed ë²„ì „ ì‚¬ìš©
2. **ì¶”ê°€ ê²€ì¦ í•„ìš”**: Train/Test ë¶„í• ë¡œ ì¬ê²€ì¦ ê¶Œì¥
3. **ìˆ˜ìˆ˜ë£Œ ì¶”ê°€ ê³ ë ¤**: ë” ë³´ìˆ˜ì ì¸ ì¶”ì •ì„ ìœ„í•´

### ğŸ“Š ìµœì¢… íŒì •

| íŒŒì¼ | íŒì • | ê¶Œì¥ ì‚¬í•­ |
|------|------|-----------|
| crypto_portfolio_strategy_comparison.py | ğŸ”´ RED | âŒ ì‚¬ìš© ê¸ˆì§€ |
| crypto_portfolio_strategy_comparison_fixed.py | ğŸŸ¢ GREEN | âœ… ì‚¬ìš© ê¶Œì¥ (ì¶”ê°€ ê²€ì¦ í›„) |
| strategy_review_analysis.py | ğŸŸ¢ GREEN | âœ… êµìœ¡ìš©ìœ¼ë¡œ ìš°ìˆ˜ |

---

## 8. ì²´í¬ë¦¬ìŠ¤íŠ¸ ìš”ì•½

### ğŸŸ¢ í†µê³¼ í•­ëª©
- âœ… Look-ahead Bias ë°©ì§€ (shift ì‚¬ìš©)
- âœ… Perfect Execution Bias ìˆ˜ì • (Fixed ë²„ì „)
- âœ… Transaction Cost ë°˜ì˜ (ìŠ¬ë¦¬í”¼ì§€)
- âœ… í˜„ì‹¤ì ì¸ ì²´ê²° ê°€ê²© (ì¢…ê°€)
- âœ… ì–‘ë°©í–¥ ìŠ¬ë¦¬í”¼ì§€ ì ìš©
- âœ… í•©ë¦¬ì ì¸ ì„±ê³¼ ì§€í‘œ

### âš ï¸ ê°œì„  í•„ìš” í•­ëª©
- âš ï¸ Train/Test ë°ì´í„° ë¶„í•  ë¶€ì¬
- âš ï¸ ìˆ˜ìˆ˜ë£Œ ë¯¸ë°˜ì˜
- âš ï¸ íŒŒë¼ë¯¸í„° ë¯¼ê°ë„ ë¶„ì„ ë¶€ì¬
- âš ï¸ Walk-Forward Analysis ë¶€ì¬

### âŒ ì¹˜ëª…ì  ë¬¸ì œ (ì´ˆê¸° ë²„ì „ë§Œ)
- âŒ Perfect Execution Bias (91% ê³¼ëŒ€í‰ê°€)

---

## 9. ìƒì„¸ ì½”ë“œ ë¶„ì„ ê²°ê³¼

### ğŸ” ë¯¸ë¬˜í•œ ë¡œì§ ê²€ì¦

#### Position Change íƒ€ì´ë° (RSI/SMA ì „ëµ)

**ì˜ë¬¸ì **: `position_change`ë¥¼ shift ì—†ì´ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ Look-ahead Biasì¸ê°€?

**ì½”ë“œ**:
```python
df['position_change'] = df['signal'].diff()  # shift ì—†ìŒ
slippage_cost[df['position_change'] == 1] = -self.slippage
```

**ê²€ì¦**:
```
Day N ì¢…ê°€ ì‹œì :
1. RSI/SMA ê³„ì‚° (ì¢…ê°€ ê¸°ì¤€) âœ…
2. Signal ìƒì„± (ì¢…ê°€ ì‹œì  ê²°ì •) âœ…
3. Position Change ê°ì§€ âœ…
4. ì¢…ê°€ì— ë§¤ìˆ˜/ë§¤ë„ ì‹¤í–‰ âœ…
5. ìŠ¬ë¦¬í”¼ì§€ ë°œìƒ âœ…

ìˆ˜ìµë¥ :
- signal.shift(1)ë¡œ "ì „ì¼ í¬ì§€ì…˜"ì˜ "ë‹¹ì¼ ìˆ˜ìµ" ê³„ì‚° âœ…
- ë‹¹ì¼ í¬ì§€ì…˜ ë³€ê²½ ì‹œ ë‹¹ì¼ ìŠ¬ë¦¬í”¼ì§€ ì°¨ê° âœ…
```

**ê²°ë¡ **: âœ… **ì •í™•í•¨** - ì¢…ê°€ ì‹œì  ê²°ì •ì´ë¯€ë¡œ Look-ahead ì•„ë‹˜

#### í„°í‹€ íŠ¸ë ˆì´ë”© ìˆ˜ìµë¥  ê³„ì‚°

**ì˜ë¬¸ì **: ìŠ¬ë¦¬í”¼ì§€ê°€ ê°€ê²©ì— í¬í•¨ë˜ì–´ ìˆëŠ”ë° ì¶”ê°€ë¡œ ë¹¼ì•¼ í•˜ëŠ”ê°€?

**ì½”ë“œ (Line 107, 111-112)**:
```python
buy_price = df.iloc[i]['Close'] * (1 + self.slippage)   # 1.002ë°°
sell_price = df.iloc[i]['Close'] * (1 - self.slippage)  # 0.998ë°°
returns = (sell_price / buy_price - 1)                   # ìë™ ë°˜ì˜
```

**ê²€ì¦**:
```
ì˜ˆì‹œ: Close = $100, slippage = 0.2%
- buy_price = $100 Ã— 1.002 = $100.20
- sell_price = $100 Ã— 0.998 = $99.80
- returns = ($99.80 / $100.20 - 1) = -0.399% âœ…

ë§Œì•½ ê°€ê²©ì´ ê·¸ëŒ€ë¡œë¼ë©´ ìŠ¬ë¦¬í”¼ì§€ë§Œí¼ ì†ì‹¤ = ì •í™•!
```

**ê²°ë¡ **: âœ… **ì •í™•í•¨** - ì¶”ê°€ ì°¨ê° ë¶ˆí•„ìš”

### ğŸ”¬ ê·¹ë‹¨ ìƒí™© í…ŒìŠ¤íŠ¸

#### 1. ì—°ì† ë§¤ìˆ˜/ë§¤ë„ (Whipsaw)
```
ì‹œë‚˜ë¦¬ì˜¤:
Day 1: ë§¤ìˆ˜ (slippage -0.2%)
Day 2: ë§¤ë„ (slippage -0.2%)
Day 3: ë§¤ìˆ˜ (slippage -0.2%)
Day 4: ë§¤ë„ (slippage -0.2%)

ì´ ìŠ¬ë¦¬í”¼ì§€: -0.8% âœ… ì •í™•íˆ ë°˜ì˜ë¨
```

#### 2. ê°€ê²© ë³€ë™ ì—†ëŠ” ê²½ìš°
```
ëª¨ë“  ë‚  Close = $100
í„°í‹€ ì „ëµ: ë§¤ìˆ˜ â†’ ë§¤ë„
- buy_price = $100.20
- sell_price = $99.80
- returns = -0.399% âœ… ìŠ¬ë¦¬í”¼ì§€ë§Œ ì†ì‹¤
```

#### 3. NaN ì²˜ë¦¬
```python
# Line 160 (RSI), Line 196 (SMA)
df['returns'] = df['returns'].fillna(0)  âœ…

# Line 110 (Turtle)
buy_price = df.iloc[i-1]['buy_price'] if pd.notna(...) else df.iloc[i-1]['Close']  âœ…
```
**íŒì •**: âœ… **ì•ˆì „í•¨** - NaN ì²˜ë¦¬ ì ì ˆ

---

## 10. ì¶”ê°€ ë°œê²¬ì‚¬í•­

### âœ… ì½”ë“œ í’ˆì§ˆ

1. **ëª…í™•í•œ ì£¼ì„**
   ```python
   # âœ… ìˆ˜ì •: ë‹¹ì¼ ì¢…ê°€ì— ë§¤ìˆ˜ (ìŠ¬ë¦¬í”¼ì§€ í¬í•¨)
   # Line 107ì²˜ëŸ¼ ìˆ˜ì • ì‚¬í•­ ëª…ì‹œ
   ```

2. **ì¼ê´€ëœ ë³€ìˆ˜ëª…**
   - `position`, `signal`, `returns` ë“± ì „ëµ ê°„ ì¼ê´€ì„±

3. **ë°©ì–´ì  í”„ë¡œê·¸ë˜ë°**
   - `pd.notna()` ì²´í¬
   - `fillna(0)` ì²˜ë¦¬

### âš ï¸ ì ì¬ì  ê°œì„ ì 

1. **ë§¤ìš° ì‘ì€ ê°€ê²© ë³€ë™ ì‹œ**
   ```python
   # í˜„ì¬: ìŠ¬ë¦¬í”¼ì§€ 0.2% ê³ ì •
   # ë¬¸ì œ: ê°€ê²© ë³€ë™ < ìŠ¬ë¦¬í”¼ì§€ ì‹œ í•­ìƒ ì†ì‹¤
   # í•´ê²°: ë™ì  ìŠ¬ë¦¬í”¼ì§€ ë˜ëŠ” ìµœì†Œ ë³´ìœ  ê¸°ê°„ ì„¤ì •
   ```

2. **ì—°ì† ì‹ í˜¸ í•„í„°ë§ ë¶€ì¬**
   ```python
   # í˜„ì¬: ë§¤ì¼ ì‹ í˜¸ ì²´í¬
   # ë¬¸ì œ: Whipsaw (ì¦ì€ ë§¤ë§¤)
   # í•´ê²°: ì‹ í˜¸ í™•ì • ê¸°ê°„ (ì˜ˆ: 2ì¼ ì—°ì†)
   ```

3. **ê±°ë˜ëŸ‰ ê²€ì¦ ë¶€ì¬**
   ```python
   # í˜„ì¬: ê±°ë˜ëŸ‰ ë¬´ì‹œ
   # ë¬¸ì œ: ì €ìœ ë™ì„± ì‹œì  ê±°ë˜ ê°€ëŠ¥ì„±
   # í•´ê²°: ìµœì†Œ ê±°ë˜ëŸ‰ ê¸°ì¤€ ì¶”ê°€
   ```

### ğŸ’¡ ëª¨ë²” ì‚¬ë¡€

1. **ì „ëµë³„ ë…ë¦½ì„±**
   - ê° ì „ëµì´ ë…ë¦½ì  ë©”ì„œë“œë¡œ êµ¬í˜„
   - í…ŒìŠ¤íŠ¸ ë° ë””ë²„ê¹… ìš©ì´

2. **íŒŒë¼ë¯¸í„°í™”**
   ```python
   def strategy_turtle_trading(self, df, entry_period=20, exit_period=10):
   ```
   - ëª¨ë“  íŒŒë¼ë¯¸í„° ì¸ìë¡œ ì „ë‹¬
   - íŒŒë¼ë¯¸í„° íŠœë‹ ê°€ëŠ¥

3. **ê²°ê³¼ ì¼ê´€ì„±**
   - ëª¨ë“  ì „ëµì´ ë™ì¼í•œ í˜•ì‹ ë°˜í™˜ (`returns`, `cumulative`)
   - í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„± ìš©ì´

---

## 11. ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸

### crypto_portfolio_strategy_comparison_fixed.py

#### í•„ìˆ˜ ì²´í¬ (í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ STOP)
- [x] 1ï¸âƒ£ Look-ahead Bias: shift(1) ì‚¬ìš© âœ…
- [x] 2ï¸âƒ£ Perfect Execution: í˜„ì‹¤ì  ì²´ê²° ê°€ê²© âœ…
- [x] 3ï¸âƒ£ Data Snooping: íŒŒë¼ë¯¸í„°ëŠ” í‘œì¤€ê°’ (Train/Test ë¶„í• ì€ ì—†ìŒ âš ï¸)
- [x] 4ï¸âƒ£ Transaction Cost: ìŠ¬ë¦¬í”¼ì§€ 0.2% âœ…

#### ë ˆë“œ í”Œë˜ê·¸ (ì˜ì‹¬í•´ì•¼ í•  ê²°ê³¼)
- [ ] âŒ ìƒ¤í”„ ë¹„ìœ¨ > 3.0? â†’ **NO** (1.12~1.60) âœ…
- [ ] âŒ ìŠ¹ë¥  > 70%? â†’ **NO** (43~51%) âœ…
- [ ] âŒ MDD < 10%? â†’ **NO** (-29~-40%) âœ…
- [ ] âŒ Train/Test ì°¨ì´ > 50%? â†’ **ì¸¡ì • ë¶ˆê°€** (ë¶„í•  ì—†ìŒ)

#### íƒ€ì„ë¼ì¸ ê²€ì¦
- [x] ì‹ í˜¸ ìƒì„±(T-1) â†’ ì²´ê²°(T) ì‹œê°„ì°¨ âœ…
- [x] ìŠ¬ë¦¬í”¼ì§€ ì ìš© ì‹œì  ì •í™• âœ…
- [x] ìˆ˜ìµë¥  ê³„ì‚° ì •í™• âœ…

#### ê·¹ë‹¨ ìƒí™© í…ŒìŠ¤íŠ¸
- [x] ì—°ì† ë§¤ìˆ˜/ë§¤ë„ (Whipsaw) âœ…
- [x] ê°€ê²© ë³€ë™ ì—†ëŠ” ê²½ìš° âœ…
- [x] NaN ì²˜ë¦¬ âœ…

### ì¢…í•© íŒì •: ğŸŸ¢ GREEN (ì‹¤ì „ ì ìš© ê°€ëŠ¥)

**ë‹¨, ë‹¤ìŒ ì¡°ê±´ ì¶©ì¡± ì‹œ**:
1. âœ… ì†Œì•¡ íˆ¬ì (ì‹œì¥ ì¶©ê²© ë¬´ì‹œ ê°€ëŠ¥í•œ ìˆ˜ì¤€)
2. âš ï¸ ì‹¤ì „ ì „ ë³„ë„ ê¸°ê°„ í…ŒìŠ¤íŠ¸ (2022-2024 ë“±)
3. âš ï¸ íŒŒë¼ë¯¸í„° ë¯¼ê°ë„ í™•ì¸
4. âš ï¸ Whipsaw ë¦¬ìŠ¤í¬ ì¸ì§€ (ì¦ì€ ë§¤ë§¤ ì‹œ ìŠ¬ë¦¬í”¼ì§€ ëˆ„ì )

---

**ê²€í†  ì™„ë£Œì¼**: 2025-11-07
**ê²€í† ì**: Backtesting Review Team
**ê¸°ì¤€**: BACKTESTING_BIAS_GUIDE.md v1.0
**ê²€í†  ë°©ë²•**:
- ì²´í¬ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ë¼ì¸ë³„ ê²€í† 
- íƒ€ì„ë¼ì¸ ì‹œë®¬ë ˆì´ì…˜
- ê·¹ë‹¨ ìƒí™© í…ŒìŠ¤íŠ¸
- ìˆ˜í•™ì  ê²€ì¦

**ì´í‰**:
Fixed ë²„ì „ì€ **ë°±í…ŒìŠ¤íŒ… í’ˆì§ˆì´ ìš°ìˆ˜**í•˜ë©° ì‹¤ì „ ì‚¬ìš© ê°€ëŠ¥ ìˆ˜ì¤€ì…ë‹ˆë‹¤.
ë‹¤ë§Œ ì‹¤ì œ íˆ¬ì ì „ ë‹¤ìŒì„ ê¶Œì¥í•©ë‹ˆë‹¤:
1. ë³„ë„ í…ŒìŠ¤íŠ¸ ê¸°ê°„ ê²€ì¦
2. ì†Œì•¡ í˜ì´í¼ íŠ¸ë ˆì´ë”©
3. Whipsaw ëŒ€ì‘ ì „ëµ ìˆ˜ë¦½ (ìµœì†Œ ë³´ìœ  ê¸°ê°„ ë“±)
