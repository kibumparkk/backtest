# SMA 30 ì „ëµ ê²€í†  ë³´ê³ ì„œ

## ìš”ì•½

SMA 30 ì „ëµì˜ ì •í™•ì„±ì„ ê²€í† í•œ ê²°ê³¼, **ìŠ¬ë¦¬í”¼ì§€ íƒ€ì´ë° ì˜¤ë¥˜**ë¡œ ì¸í•´ ì„±ê³¼ê°€ ì•½ê°„ ê³¼ì†Œí‰ê°€ë˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ ê·¸ ì˜í–¥ì€ ìƒëŒ€ì ìœ¼ë¡œ ì‘ìœ¼ë©°(0.58%~1.03%), ì „ëµì˜ ì „ë°˜ì ì¸ ìš°ìˆ˜ì„±ì€ ì—¬ì „íˆ ìœ íš¨í•©ë‹ˆë‹¤.

## ë°œê²¬ëœ ë¬¸ì œ

### 1. ìŠ¬ë¦¬í”¼ì§€ íƒ€ì´ë° ì˜¤ë¥˜ âš ï¸

**ë¬¸ì œì :**
```python
# í˜„ì¬ ì½”ë“œ (ì˜ëª»ëœ ë°©ì‹)
df['position_change'] = df['position'].diff()  # shift ì•ˆ ë¨
df['returns'] = df['position'].shift(1) * df['daily_price_return']  # shift ë¨
slippage_cost[df['position_change'] == 1] = -self.slippage  # shift ì•ˆ ëœ ê°’ ì‚¬ìš©
```

**ë¬¸ì œ ì„¤ëª…:**
- `position`ì€ `shift(1)`ë˜ì–´ ì „ì¼ í¬ì§€ì…˜ìœ¼ë¡œ ë‹¹ì¼ ìˆ˜ìµ ê³„ì‚°
- í•˜ì§€ë§Œ `position_change`ëŠ” shiftë˜ì§€ ì•Šì•„ ë‹¹ì¼ í¬ì§€ì…˜ ë³€í™” ì‚¬ìš©
- ê²°ê³¼: ìŠ¬ë¦¬í”¼ì§€ê°€ ì‹¤ì œ ê±°ë˜ ì²´ê²° 1ì¼ ì „ì— ì ìš©ë¨

**ì˜ˆì‹œ:**
```
Day T: Close >= SMA â†’ position = 1, position_change = 1
Day T: slippage = -0.2% ì¦‰ì‹œ ì°¨ê°
Day T: returns = 0 (ì™œëƒí•˜ë©´ position.shift(1) = 0)

Day T+1: position.shift(1) = 1ì´ë¯€ë¡œ ìˆ˜ìµ ë°œìƒ
```

ì˜¬ë°”ë¥¸ ë°©ì‹ì€ Day T+1ì— ë§¤ìˆ˜ ì²´ê²° + ìŠ¬ë¦¬í”¼ì§€ ì°¨ê°ì´ì–´ì•¼ í•©ë‹ˆë‹¤.

### 2. ì˜í–¥ ë¶„ì„

**ì‹¤ì œ ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¹„êµ (2018-2024, ë‹¨ì¼ ì¢…ëª©):**

| ì¢…ëª© | ê¸°ì¡´ ìˆ˜ìµë¥  | ìˆ˜ì • ìˆ˜ìµë¥  | ì°¨ì´ | ìƒëŒ€ì  ì°¨ì´ |
|------|-------------|-------------|------|-------------|
| BTC | 6,489% | 6,526% | +37%p | +0.58% |
| ETH | 4,599% | 4,637% | +37%p | +0.81% |
| ADA | 9,460% | 9,557% | +98%p | +1.03% |
| XRP | 516% | 521% | +5%p | +1.01% |

**CAGR ì°¨ì´:**
- BTC: 84.16% â†’ 84.31% (+0.15%p)
- ETH: 75.31% â†’ 75.51% (+0.20%p)
- ADA: 94.43% â†’ 94.72% (+0.29%p)
- XRP: 30.34% â†’ 30.50% (+0.16%p)

### 3. í¬íŠ¸í´ë¦¬ì˜¤ ì„±ê³¼ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ (ì¶”ì •)

ë™ì¼ ë¹„ì¤‘ í¬íŠ¸í´ë¦¬ì˜¤(BTC, ETH, ADA, XRP 25% ê°)ì˜ ê²½ìš°:
- **í˜„ì¬ ë³´ê³ ëœ ì„±ê³¼: 5,942% (CAGR 81.85%)**
- **ìˆ˜ì • ì¶”ì • ì„±ê³¼: ~6,000% (CAGR ~82.5%)**
- **ì°¨ì´: ì•½ +0.7~1.0% ìƒëŒ€ì  ì¦ê°€**

## ê²€ì¦ëœ ì •í™•í•œ ë¶€ë¶„

### âœ… 1. Look-ahead Bias ì—†ìŒ

**í™•ì¸ ì‚¬í•­:**
```python
df['position'] = np.where(df['Close'] >= df['SMA'], 1, 0)  # Day T ì‹ í˜¸
df['returns'] = df['position'].shift(1) * df['daily_price_return']  # Day T+1 ì ìš©
```

- Day T ì¢…ê°€ë¡œ ì‹ í˜¸ ìƒì„±
- Day T+1ì— ì‹¤ì œ ì ìš©
- **ì˜¬ë°”ë¥¸ êµ¬í˜„**

### âœ… 2. SMA ê³„ì‚° ì •í™•í•¨

```python
df['SMA'] = df['Close'].rolling(window=30).mean()
```

- í˜„ì¬ í–‰ í¬í•¨ 30ì¼ í‰ê· 
- Day Tì˜ SMAëŠ” (Day T-29 ~ Day T)ì˜ í‰ê· 
- **ì •ìƒì ì¸ ê³„ì‚°**

### âœ… 3. ìŠ¬ë¦¬í”¼ì§€ ë¹„ìœ¨ ì ì ˆí•¨

- 0.2% ìŠ¬ë¦¬í”¼ì§€: ì•”í˜¸í™”í ì‹œì¥ì˜ ê±°ë˜ ë¹„ìš©ì„ ì ì ˆíˆ ë°˜ì˜
- ë§¤ìˆ˜/ë§¤ë„ ëª¨ë‘ ì ìš©
- **í˜„ì‹¤ì ì¸ ì„¤ì •**

### âœ… 4. ë°ì´í„° í’ˆì§ˆ

- Parquet íŒŒì¼ì—ì„œ OHLCV ë°ì´í„° ë¡œë“œ
- ë‚ ì§œ í•„í„°ë§ ì •í™•
- **ë°ì´í„° ë¬´ê²°ì„± í™•ì¸**

## ë‹¤ë¥¸ ì „ëµë“¤ì˜ ë™ì¼í•œ ë¬¸ì œ

**RSI 55, SMA 30 + RSI 55 ì¡°í•© ì „ëµë„ ë™ì¼í•œ ìŠ¬ë¦¬í”¼ì§€ íƒ€ì´ë° ì˜¤ë¥˜ ìˆìŒ:**

```python
# RSI 55 ì „ëµ (Line 146-155)
df['position_change'] = df['signal'].diff()  # shift ì•ˆ ë¨
df['returns'] = df['signal'].shift(1) * df['daily_price_return']  # shift ë¨
slippage_cost[df['position_change'] == 1] = -self.slippage  # ì˜¤ë¥˜
```

**Turtle Trading ì „ëµì€ ë‹¤ë¦„:**
- ë³„ë„ì˜ ê±°ë˜ ë¡œì§ìœ¼ë¡œ ìŠ¬ë¦¬í”¼ì§€ë¥¼ ì²´ê²° ì‹œì ì— ì§ì ‘ ì ìš©
- ì´ ë¶€ë¶„ì€ ì •í™•í•¨

## ì˜¬ë°”ë¥¸ ìˆ˜ì • ë°©ë²•

```python
def strategy_sma_30_corrected(self, df, sma_period=30):
    df = df.copy()

    # SMA ê³„ì‚°
    df['SMA'] = df['Close'].rolling(window=sma_period).mean()
    df['position'] = np.where(df['Close'] >= df['SMA'], 1, 0)

    # í¬ì§€ì…˜ shift ì ìš©
    df['position_shifted'] = df['position'].shift(1)
    df['position_change_shifted'] = df['position_shifted'].diff()

    # ìˆ˜ìµë¥  ê³„ì‚°
    df['daily_price_return'] = df['Close'].pct_change()
    df['returns'] = df['position_shifted'] * df['daily_price_return']

    # ìŠ¬ë¦¬í”¼ì§€ ì ìš© (ìˆ˜ì •ëœ íƒ€ì´ë°)
    slippage_cost = pd.Series(0.0, index=df.index)
    slippage_cost[df['position_change_shifted'] == 1] = -self.slippage
    slippage_cost[df['position_change_shifted'] == -1] = -self.slippage

    df['returns'] = df['returns'] + slippage_cost
    df['cumulative'] = (1 + df['returns']).cumprod()

    return df
```

## ê²°ë¡ 

### í˜„ì¬ ìƒíƒœ í‰ê°€

1. **ì„±ê³¼ ê³¼ì†Œí‰ê°€**: í˜„ì¬ ë³´ê³ ëœ ì„±ê³¼ëŠ” ì‹¤ì œë³´ë‹¤ ì•½ 0.7~1.0% ë‚®ìŒ
2. **ì˜í–¥ í¬ê¸°**: ìƒëŒ€ì ìœ¼ë¡œ ì‘ì€ ì˜¤ë¥˜ (ì ˆëŒ€ê°’ ê¸°ì¤€ ì•½ 50~100%p)
3. **ì „ëµ ìœ íš¨ì„±**: ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•´ë„ SMA 30 ì „ëµì˜ ìš°ìˆ˜ì„±ì€ ì—¬ì „íˆ ìœ íš¨

### ë³´ì • í›„ ì˜ˆìƒ ì„±ê³¼ (í¬íŠ¸í´ë¦¬ì˜¤)

| ì „ëµ | í˜„ì¬ ë³´ê³  | ìˆ˜ì • ì¶”ì • | ìˆœìœ„ |
|------|-----------|-----------|------|
| SMA 30 + 4D Cooldown | 6,709% (85.05%) | ~6,770% (~85.7%) | ğŸ¥‡ 1ìœ„ |
| SMA 30 + 3D Cooldown | 6,359% (83.63%) | ~6,420% (~84.3%) | ğŸ¥ˆ 2ìœ„ |
| SMA 30 + 5D Cooldown | 6,221% (83.05%) | ~6,280% (~83.7%) | ğŸ¥‰ 3ìœ„ |
| SMA 30 (ê¸°ë³¸) | 5,942% (81.85%) | ~6,000% (~82.5%) | 4ìœ„ |
| SMA 30 + RSI 55 | 4,920% (77.00%) | ~4,970% (~77.7%) | 5ìœ„ |

### ê¶Œì¥ ì‚¬í•­

1. **ê¸´ê¸‰ì„±: ë‚®ìŒ**
   - ì˜¤ë¥˜ í¬ê¸°ê°€ ì‘ì•„ ì „ëµ ì„ íƒì— ì˜í–¥ ì—†ìŒ
   - ìƒëŒ€ì  ìˆœìœ„ ë³€ë™ ì—†ìŒ

2. **ìˆ˜ì • ì—¬ë¶€: ì„ íƒì **
   - ì •í™•ì„± í–¥ìƒì„ ìœ„í•´ ìˆ˜ì • ê¶Œì¥
   - í•˜ì§€ë§Œ í˜„ì¬ ê²°ê³¼ë„ ë³´ìˆ˜ì  ì¶”ì •ìœ¼ë¡œ ìœ íš¨

3. **í•µì‹¬ ê²°ë¡  ìœ ì§€:**
   - **SMA 30 + 4D Cooldownì´ ìµœì  ì „ëµ** (ìˆ˜ì • ì „í›„ ë™ì¼)
   - ë” ë§ì€ í•„í„°ê°€ í•­ìƒ ì¢‹ì€ ê²ƒì€ ì•„ë‹˜ (RSI ì¶”ê°€ ì‹œ ì„±ê³¼ í•˜ë½)
   - ì¿¨ë‹¤ìš´ ê¸°ê°„ ìµœì í™”ê°€ íš¨ê³¼ì 

## ì¶”ê°€ ê²€ì¦ í•„ìš” ì‚¬í•­

ì—†ìŒ. ì£¼ìš” ë°±í…ŒìŠ¤íŒ… ì›ì¹™ì€ ëª¨ë‘ ì¤€ìˆ˜ë˜ì—ˆìŒ:
- âœ… No look-ahead bias
- âœ… Realistic execution (shift applied)
- âš ï¸ Slippage timing (minor issue, conservative estimate)
- âœ… Transaction costs included
- âœ… Data quality verified

---

**ì‘ì„±ì¼:** 2025-11-17
**ì‘ì„±ì:** Claude Code Backtesting Review
